<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Lista de Funcionários</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="//cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css">
</head>

<body>
	<div class="container mt-5">
		<h1 class="mb-4">Lista de Funcionários</h1>

		<!-- Botão para adicionar um novo funcionário -->
		<div class="mb-4">
			<a href="/funcionario" class="btn btn-primary">Novo</a>
		</div>

		<!-- Campo de busca -->
		<input type="text" id="filterInput" class="form-control mb-4" placeholder="Pesquisar por nome ou função">

		<!-- Tabela de funcionários -->
		<table id="funcionariosTable" class="table table-hover table-striped">
			<thead class="table-dark">
				<tr>
					<th>NOME</th>
					<th>Função</th>
					<th>Data Admissão</th>
					<th>Salário</th>
					<th>Ações</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="funcionario : ${lista}">
					<td th:text="${funcionario.nome}"></td>
					<td th:text="${funcionario.funcao}"></td>
					<td th:text="${funcionario.dtadm}"></td>
					<td th:text="${funcionario.salario}"></td>
					<td>
						<a th:href="@{/funcionario/formFuncionario(id=${funcionario.id})}"
							class="btn btn-warning btn-sm">Editar</a>
						<form th:action="@{/funcionario}" method="post" style="display:inline;">
							<input type="hidden" name="_method" value="delete">
							<input type="hidden" name="id" th:value="${funcionario.id}">
							<button type="submit" class="btn btn-danger btn-sm">Excluir</button>
						</form>
					</td>
				</tr>
			</tbody>
		</table>
	</div>

	<!-- Inclusão das bibliotecas -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="//code.jquery.com/jquery-3.2.1.min.js"></script>
	<script src="//cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>

	<!-- Script para inicializar o DataTables e filtro -->
	<script>
		$(document).ready(function () {
			// Inicializa o DataTable
			const table = $('#funcionariosTable').DataTable({
				"language": {
					"lengthMenu": "Mostrando _MENU_ registros por página",
					"zeroRecords": "Nada encontrado",
					"info": "Mostrando página _PAGE_ de _PAGES_",
					"infoEmpty": "Nenhum registro disponível",
					"infoFiltered": "(filtrado de _MAX_ registros no total)",
					"sLoadingRecords": "Carregando...",
					"sProcessing": "Processando...",
					"sSearch": "Pesquisar",
					"oPaginate": {
						"sNext": "Próximo",
						"sPrevious": "Anterior",
						"sFirst": "Primeiro",
						"sLast": "Último"
					}
				}
			});

			// Pesquisa por nome e função
			$('#filterInput').on('keyup', function () {
				table.search(this.value).draw();
			});
		});
	</script>
</body>

</html>